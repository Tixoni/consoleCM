@echo off
chcp 65001 >nul
title Эмулятор терминала - Тестирование

echo ==================================================
echo Эмулятор терминала - Тестовый запуск
echo ==================================================
echo.

REM Проверяем наличие Python
python --version >nul 2>&1
if errorlevel 1 (
    echo ОШИБКА: Python не установлен или не добавлен в PATH
    echo Установите Python и добавьте его в переменную окружения PATH
    pause
    exit /b 1
)

echo Python обнаружен, продолжаем...
echo.

REM Создаем тестовую VFS директорию если её нет
if not exist vfs (
    mkdir vfs
    echo Создана тестовая VFS директория: vfs
) else (
    echo VFS директория уже существует: vfs
)

echo.
echo ==================================================
echo ТЕСТ 1: Запуск без параметров (значения по умолчанию)
echo ==================================================
echo.
python main.py
if errorlevel 1 (
    echo.
    echo ОШИБКА: Программа завершилась с ошибкой
) else (
    echo.
    echo ТЕСТ 1 завершен успешно
)

echo.
echo Нажмите любую клавишу для продолжения...
pause >nul

echo.
echo ==================================================
echo ТЕСТ 2: Запуск с несуществующей VFS (проверка ошибок)
echo ==================================================
echo.
python main.py --vfs-path ./nonexistent_vfs
if errorlevel 1 (
    echo.
    echo ОЖИДАЕМАЯ ОШИБКА: VFS путь не существует - обработка работает корректно
) else (
    echo.
    echo ПРЕДУПРЕЖДЕНИЕ: Ожидалась ошибка, но программа завершилась успешно
)

echo.
echo Нажмите любую клавишу для продолжения...
pause >nul

echo.
echo ==================================================
echo ТЕСТ 3: Запуск с корректными параметрами и скриптом
echo ==================================================
echo.
echo Содержимое стартового скрипта:
echo -------------------------------
type startup_script.txt
echo -------------------------------
echo.

python main.py --vfs-path ./vfs --startup-script startup_script.txt
if errorlevel 1 (
    echo.
    echo ОШИБКА: Программа завершилась с ошибкой при корректных параметрах
) else (
    echo.
    echo ТЕСТ 3 завершен успешно
)

echo.
echo Нажмите любую клавишу для продолжения...
pause >nul

echo.
echo ==================================================
echo ТЕСТ 4: Запуск с несуществующим скриптом
echo ==================================================
echo.
python main.py --vfs-path ./vfs --startup-script nonexistent_script.txt
if errorlevel 1 (
    echo.
    echo ОЖИДАЕМАЯ ОШИБКА: Скрипт не найден - обработка работает корректно
) else (
    echo.
    echo ПРЕДУПРЕЖДЕНИЕ: Ожидалась ошибка, но программа завершилась успешно
)

echo.
echo ==================================================
echo ВСЕ ТЕСТЫ ЗАВЕРШЕНЫ
echo ==================================================
echo.
echo Логика тестирования:
echo - ТЕСТ 1: Проверка работы по умолчанию
echo - ТЕСТ 2: Проверка обработки ошибок VFS
echo - ТЕСТ 3: Полноценная работа со скриптом
echo - ТЕСТ 4: Проверка обработки ошибок скрипта
echo.
echo Отладочный вывод параметров можно увидеть в консоли
echo перед запуском графического интерфейса.
echo.
pause